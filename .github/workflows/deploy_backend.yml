name: Deploy Laravel Project on push
on:
  push:
    branches:
      - main
      
jobs:
  web-deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Get the latest code
        uses: actions/checkout@v4
      #- uses: actions/setup-node@master
      #- name: Copy .env
      #  run: php -r "file_exists('.env') || copy('.env.example', '.env');"
      #- name: Install Dependencies
      #  run: composer update --ignore-platform-reqs
      #- name: Generate key
      #  run: php artisan key:generate
      #- name: Generate storage link
      #  run: php artisan storage:link
      #- name: Directory Permissions
      #  run: chmod -R 777 storage bootstrap/cache
      - name: ðŸ“‚ Sync files
        uses: SamKirkland/FTP-Deploy-Action@3.0.0
        with:
          server: ${{ secrets.API_SFTP_HOST }}
          username: ${{ secrets.API_SFTP_USERNAME }}
          password: ${{ secrets.API_SFTP_PASSWORD }}
          local-dir: ./api/
          server-dir: /


#jobs:
#  deploy:
#    name: ðŸŽ‰ Deploy Backend
#    runs-on: ubuntu-latest

#    steps:
#      - name: ðŸšš Get latest code
#        uses: actions/checkout@v3
#        with:
#          fetch-depth: 0


 #     - name: Push files
 #       uses: SamKirkland/FTP-Deploy-Action@v4.3.4
 #       with:
#          server: my-ftp.ibrahimsari.com.tr
 #         username: github-ftp-deployer@asset-management-api.ibrahimsari.com.tr
  #        password: ${{ secrets.API_SFTP_PASSWORD }}

     # - name: Upload file
      #  uses: tomasbkk/action-ftp-upload@v1.0
       # with:
        #  user: ${{ secrets.API_SFTP_USERNAME }}
         # password: ${{ secrets.API_SFTP_PASSWORD }}
         # host: ${{ secrets.API_SFTP_HOST }}
          #src: ./api/**
          #dest: ./test/**

      # - name: ðŸ“‚ Sync files
        # uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        # with:
          # server: ${{ secrets.API_SFTP_HOST }}
          # username: ${{ secrets.API_SFTP_USERNAME }}
          # password: ${{ secrets.API_SFTP_PASSWORD }}
          # port: ${{ secrets.API_SFTP_PORT }}
          # local-dir: './api/'
          # server-dir: './test/'

      # - name: ðŸ“‚ Transfer files via FTP
        # uses: GenieTim/ftp-action@v4.0.1
        # with:
          # host: ${{ secrets.API_SFTP_HOST }}
          # user: ${{ secrets.API_SFTP_USERNAME }}
          # password: ${{ secrets.API_SFTP_PASSWORD }}
          # localDir: './api'
          # remoteDir: ./test'

      # - name: ðŸ“‚ Transfer files via SFTP
        # uses: pressidium/lftp-mirror-action@v1
        # with:
          # # SFTP credentials
          # host: ${{ secrets.API_SFTP_HOST }}
          # port: ${{ secrets.API_SFTP_PORT }}
          # user: ${{ secrets.API_SFTP_USERNAME }}
          # pass: ${{ secrets.API_SFTP_PASSWORD }}
          # # lftp settings
          # onlyNewer: true
          # settings: 'sftp:auto-confirm=yes'
          # forceSSL: false
          # # Mirror command options
          # localDir: './api'
          # remoteDir: './test'
          # reverse: true
          # ignoreFile: '.lftp_ignore'
          # options: '--verbose'
