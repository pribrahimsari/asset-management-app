# https://stackoverflow.com/questions/70996923/is-that-possible-to-deploy-laravel-web-application-to-shared-hosting-using-githu

# DO NOT FORGET:
#  on DreamHost:
#   Web directory MUST END WITH /public for LARAVEL
#    EXAMPLE: site-name/public

name: ðŸš€ Deploy Backend on push main branch and on api/** folder change

on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'api/**'

jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Upload from public_html via FTP
        uses: airvzxf/ftp-deployment-action@latest
        with:
          server: "198.177.120.62"
          user: "github-ftp-deployer@asset-management-api.ibrahimsari.com.tr"
          password: ${{ secrets.API_SFTP_PASSWORD }}
          local_dir: "./api"


#jobs:
#  deploy:
#    name: ðŸŽ‰ Deploy Backend
#    runs-on: ubuntu-latest

#    steps:
#      - name: ðŸšš Get latest code
#        uses: actions/checkout@v3
#        with:
#          fetch-depth: 0


 #     - name: Push files
 #       uses: SamKirkland/FTP-Deploy-Action@v4.3.4
 #       with:
#          server: my-ftp.ibrahimsari.com.tr
 #         username: github-ftp-deployer@asset-management-api.ibrahimsari.com.tr
  #        password: ${{ secrets.API_SFTP_PASSWORD }}

     # - name: Upload file
      #  uses: tomasbkk/action-ftp-upload@v1.0
       # with:
        #  user: ${{ secrets.API_SFTP_USERNAME }}
         # password: ${{ secrets.API_SFTP_PASSWORD }}
         # host: ${{ secrets.API_SFTP_HOST }}
          #src: ./api/**
          #dest: ./test/**

      # - name: ðŸ“‚ Sync files
        # uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        # with:
          # server: ${{ secrets.API_SFTP_HOST }}
          # username: ${{ secrets.API_SFTP_USERNAME }}
          # password: ${{ secrets.API_SFTP_PASSWORD }}
          # port: ${{ secrets.API_SFTP_PORT }}
          # local-dir: './api/'
          # server-dir: './test/'

      # - name: ðŸ“‚ Transfer files via FTP
        # uses: GenieTim/ftp-action@v4.0.1
        # with:
          # host: ${{ secrets.API_SFTP_HOST }}
          # user: ${{ secrets.API_SFTP_USERNAME }}
          # password: ${{ secrets.API_SFTP_PASSWORD }}
          # localDir: './api'
          # remoteDir: ./test'

      # - name: ðŸ“‚ Transfer files via SFTP
        # uses: pressidium/lftp-mirror-action@v1
        # with:
          # # SFTP credentials
          # host: ${{ secrets.API_SFTP_HOST }}
          # port: ${{ secrets.API_SFTP_PORT }}
          # user: ${{ secrets.API_SFTP_USERNAME }}
          # pass: ${{ secrets.API_SFTP_PASSWORD }}
          # # lftp settings
          # onlyNewer: true
          # settings: 'sftp:auto-confirm=yes'
          # forceSSL: false
          # # Mirror command options
          # localDir: './api'
          # remoteDir: './test'
          # reverse: true
          # ignoreFile: '.lftp_ignore'
          # options: '--verbose'
